1ï¸âƒ£ é©±åŠ¨å®‰è£…ä¸æ£€æµ‹

Ubuntu é»˜è®¤å¸¦ ALSA é©±åŠ¨ï¼Œå¤§éƒ¨åˆ†å£°å¡å’Œ USB è€³æœºå³æ’å³ç”¨ã€‚
å¦‚æœæ˜¯å®šåˆ¶ç¡¬ä»¶æˆ–æ— å£°å¡ï¼Œéœ€æ‰‹åŠ¨å®‰è£…ï¼š
sudo apt update
sudo apt install alsa-base alsa-utils linux-sound-base -y
æ£€æµ‹å£°å¡ï¼š
lspci | grep -i audio   # PCI å£°å¡
lsusb | grep -i audio   # USB éŸ³é¢‘è®¾å¤‡
åˆ—å‡ºå¯ç”¨è®¾å¤‡ï¼š
aplay -l    # æ’­æ”¾è®¾å¤‡
arecord -l  # å½•éŸ³è®¾å¤‡
ğŸ“Œ å¦‚æœè¾“å‡ºé‡Œèƒ½çœ‹åˆ° card 0ã€device 0 ä¹‹ç±»ï¼Œè¯´æ˜é©±åŠ¨åŠ è½½æˆåŠŸã€‚
2ï¸âƒ£ å®‰è£… PipeWire éŸ³é¢‘æœåŠ¡

Ubuntu 24 é»˜è®¤ä½¿ç”¨ PipeWireï¼Œå»ºè®®ç²¾ç®€å®‰è£…ï¼š
sudo apt install --no-install-recommends \
    pipewire wireplumber pipewire-audio-client-libraries -y

ç¦ç”¨ PulseAudioï¼Œé¿å…å†²çªï¼š
systemctl --user mask pulseaudio
systemctl --user stop pulseaudio.socket pulseaudio.service

å¯ç”¨ PipeWireï¼š
systemctl --user enable --now pipewire pipewire-pulse wireplumber

éªŒè¯ï¼š
pactl info | grep "Server Name"

è¾“å‡ºåº”ä¸ºï¼š
Server Name: PulseAudio (on PipeWire 0.3.x)

å®‰è£… FreeRDP
sudo apt install freerdp2-x11 freerdp2-wayland freerdp2-shadow-cli -y

4ï¸âƒ£ æœ¬åœ°éŸ³é¢‘æµ‹è¯•

æµ‹è¯•æ’­æ”¾ï¼š
speaker-test -t sine -f 440 -D default -c 2

æµ‹è¯•å½•éŸ³ï¼š
arecord -f cd test.wav
aplay test.wav

FreeRDP éŸ³é¢‘æµå¼è½¬å‘

è¿œç«¯å£°éŸ³ â†’ æœ¬åœ°æ’­æ”¾
xfreerdp /v:<server_ip> /u:<username> /p:<password> /sound:sys:pipewire
æœ¬åœ°éº¦å…‹é£ â†’ è¿œç«¯è¾“å…¥
xfreerdp /v:<server_ip> /u:<username> /p:<password> /microphone:sys:pipewire

åŒå‘æµå¼éŸ³é¢‘

xfreerdp /v:<server_ip> /u:<username> /p:<password> \
  /sound:sys:pipewire /microphone:sys:pipewire

ğŸ¯ å£°éŸ³é‡å®šå‘åˆ° ThinClient çš„æœºåˆ¶
1ï¸âƒ£ Windows Server â†’ ThinClient

FreeRDP é»˜è®¤æ”¯æŒ RDP Audio Redirection åè®®ï¼š

Windows çš„ç³»ç»Ÿå£°éŸ³ / åº”ç”¨å£°éŸ³ ä¼šè¢«ç¼–ç ï¼ˆRDP-PCM/WAV/AACï¼‰

é€šè¿‡ RDP é€šé“ä¼ è¾“åˆ°å®¢æˆ·ç«¯

ThinClientï¼ˆxfreerdpï¼‰è§£ç  â†’ PipeWire/ALSA æ’­æ”¾

ğŸ‘‰ åœ¨ ThinClient å¯åŠ¨ FreeRDP æ—¶åŠ ä¸Šï¼š

xfreerdp /v:<server_ip> /u:<username> /p:<password> /sound:sys:pipewire


è¿™æ · è¿œç«¯ Windows çš„å£°éŸ³ å°±ä¼šç›´æ¥æ’­æ”¾åœ¨ ThinClient æœ¬åœ°ã€‚
ï¼ˆå¦‚æœä¸æŒ‡å®š sys:pipewireï¼Œä¹Ÿå¯ä»¥ç”¨ sys:pulse æˆ– sys:alsaï¼Œä½† Ubuntu24 æ¨è pipewireï¼‰

2ï¸âƒ£ Linux Server â†’ ThinClient

Linux ç«¯æ¯”è¾ƒå¤æ‚ï¼Œå› ä¸º RDP å¹¶ä¸æ˜¯ Linux åŸç”Ÿåè®®ã€‚å¸¸è§å‡ ç§æ–¹å¼ï¼š

ğŸ”¹ (A) ä½¿ç”¨ xrdp

åœ¨ Linux Server å®‰è£… xrdpï¼š

sudo apt install xrdp pulseaudio-module-xrdp


å¯åŠ¨æœåŠ¡ï¼š

sudo systemctl enable --now xrdp


ThinClient ç«¯ç”¨ FreeRDP è¿æ¥ï¼š

xfreerdp /v:<linux_server_ip> /u:<username> /p:<password> /sound:sys:pipewire


ğŸ‘‰ å£°éŸ³ä¼šé€šè¿‡ PulseAudio â†’ xrdp éŸ³é¢‘é€šé“ â†’ RDP â†’ ThinClientã€‚

ğŸ”¹ (B) ä½¿ç”¨ PulseAudio ç½‘ç»œä¼ è¾“

å¦‚æœä¸ç”¨ RDPï¼Œä»…ä»…è¦æŠŠ Linux Server çš„å£°éŸ³è½¬åˆ° ThinClientï¼Œå¯ä»¥ç›´æ¥ç”¨ PulseAudio çš„ç½‘ç»œæ¨¡å—ï¼š

Linux Server ç«¯ï¼š

pactl load-module module-native-protocol-tcp auth-ip-acl=<thinclient_ip>


ThinClient ç«¯ï¼š

export PULSE_SERVER=<server_ip>
paplay /usr/share/sounds/alsa/Front_Center.wav


ğŸ‘‰ æ‰€æœ‰å£°éŸ³ä¼šè¢«è½¬å‘åˆ° ThinClient çš„ PipeWire/PulseAudio æ’­æ”¾ã€‚

ğŸ”¹ (C) ä½¿ç”¨ GStreamer / RTP / WebRTC

é€‚åˆå®æ—¶éŸ³é¢‘æµè½¬å‘åœºæ™¯ï¼Œä¾‹å¦‚å¤šåª’ä½“æ’­æ”¾ã€è¿œç¨‹æ•™å­¦ï¼š

# Server ç«¯æ¨é€
gst-launch-1.0 pulsesrc ! audioconvert ! audioresample ! opusenc ! rtpopuspay ! udpsink host=<thinclient_ip> port=5000

# ThinClient ç«¯æ¥æ”¶
gst-launch-1.0 udpsrc port=5000 caps="application/x-rtp" ! rtpopusdepay ! opusdec ! audioconvert ! audioresample ! autoaudiosink

3ï¸âƒ£ éªŒè¯å£°éŸ³é‡å®šå‘
Windows Server éªŒè¯

åœ¨è¿œç«¯ Windows æ’­æ”¾ä¸€ä¸ªè§†é¢‘

å£°éŸ³åº”è¯¥ç›´æ¥å‡ºç°åœ¨ ThinClient

Linux Server (xrdp) éªŒè¯

åœ¨è¿œç«¯ Linux æ’­æ”¾æµ‹è¯•éŸ³é¢‘ï¼š

paplay /usr/share/sounds/alsa/Front_Center.wav


ç¡®è®¤ ThinClient èƒ½å¬åˆ°å£°éŸ³

PulseAudio ç½‘ç»œéªŒè¯

åœ¨ Linux Server æ’­æ”¾å£°éŸ³ï¼ŒThinClient ä½œä¸ºè¾“å‡ºè®¾å¤‡

pavucontrol å¯ä»¥çœ‹åˆ°éŸ³é¢‘æµ

ğŸ“ æ€»ç»“

Windows â†’ ThinClientï¼šFreeRDP çš„ /sound å°±èƒ½å¸¦å›å£°éŸ³

Linux â†’ ThinClientï¼š

æ¨èç”¨ xrdp + FreeRDP /sound

è½»é‡çº§å¯ä»¥ç”¨ PulseAudio over TCP

å®æ—¶å¤šåª’ä½“å¯ç”¨ GStreamer RTP/WebRTC



